scale_x_log10()+
scale_y_log10()+
geom_smooth(method = "lm")
cor(corr1$gdp, corr1$count, use="complete.obs")
corr1 = star %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=gdp, y=count))+
geom_point()+
scale_x_log10()+
scale_y_log10()+
geom_smooth(method = "lm")
corr1 = star %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=gdp, y=count))+
geom_point()+
scale_x_log10()+
scale_y_log10()+
geom_smooth(method = "lm")
corr1 = star %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=gdp, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$gdp, corr1$count, use="complete.obs")
corr1 = star1 %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=gdp, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$gdp, corr1$count, use="complete.obs")
corr1 = star1 %>%
group_by(country, bus_perf) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=nus_perf, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
corr1 = star1 %>%
group_by(country, bus_perf) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=bus_perf, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
head(star1)
corr1 = star1 %>%
group_by(country, median_age) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=median_age, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
corr1 = star1 %>%
group_by(country, median_age) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=median_age, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$median_age, corr1$count, use="complete.obs")
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$urban_pop, corr1$count, use="complete.obs")
runApp()
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
#scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$urban_pop, corr1$count, use="complete.obs")
cor(corr1$urban_pop, corr1$count, use="complete.obs")
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
cor(corr1$urban_pop, corr1$count, use="complete.obs")
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
library(pinyin)
head(star6)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
library(pinyin)
knitr::opts_chunk$set(echo = TRUE)
starbucks = read.csv('./data/starbucks2.csv', stringsAsFactors=FALSE)
starbucks %>%
mutate(City= ifelse(Country=="CN", pinyin("City", sep= ' '), City))
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
starbucks = read.csv('./data/starbucks2.csv', stringsAsFactors=FALSE)
starbucks$store_count = rep(1, dim(starbucks)[1])
star1= starbucks%>%
select(c(-Postcode, -Phone.Number))
head(star1)
code = read.csv('./data/country_code.csv')
code= code%>%
mutate(Country_Name= word(Country_Name, 1, sep=','))
code = code %>%
mutate(Country_Name= ifelse(Country_Name=='Azerbaijan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Georgia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Kazakhstan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Russian Federation' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Armenia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Korea' , 'South Korea',Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='United States of America' , 'United States',Country_Name))
code = code %>%
filter(Country_Name != 'NULL')
code= rename(code, continent= 'Continent_Name',
Country= 'Two_Letter_Country_Code')
code = code %>%
filter(Country_Name != '')
head(code, 5)
#Merge code and starbucks so we can have a complete for the country
star2= full_join(star1, code, by='Country')
star3= star2 %>%
mutate(store_count= ifelse(is.na(store_count), 0, store_count))
names(star3) = tolower(names(star3))
star3= rename(star3, code= 'country',
country ='country_name')
data1 = read.csv('./data/urban_pop.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data1 = rename(data1, "country"=X.U.FEFF.country)
star4=left_join(star3, data1, by='country')
head(star1)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
star5=left_join(star4, data2, by='country')
head(star5)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data3 = read.csv('./data/business.csv')
star6=left_join(star5, data3, by='country')
data3 = read.csv('./data/business.csv')
star6=left_join(star5, data3, by='country')
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
knitr::opts_chunk$set(echo = TRUE)
starbucks = read.csv('./data/starbucks2.csv', stringsAsFactors=FALSE)
starbucks$store_count = rep(1, dim(starbucks)[1])
star1= starbucks%>%
select(c(-Postcode, -Phone.Number))
head(star1)
code = read.csv('./data/country_code.csv')
code= code%>%
mutate(Country_Name= word(Country_Name, 1, sep=','))
code = code %>%
mutate(Country_Name= ifelse(Country_Name=='Azerbaijan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Georgia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Kazakhstan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Russian Federation' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Armenia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Korea' , 'South Korea',Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='United States of America' , 'United States',Country_Name))
code = code %>%
filter(Country_Name != 'NULL')
code= rename(code, continent= 'Continent_Name',
Country= 'Two_Letter_Country_Code')
code = code %>%
filter(Country_Name != '')
head(code, 5)
#Merge code and starbucks so we can have a complete for the country
star2= full_join(star1, code, by='Country')
star3= star2 %>%
mutate(store_count= ifelse(is.na(store_count), 0, store_count))
names(star3) = tolower(names(star3))
star3= rename(star3, code= 'country',
country ='country_name')
data1 = read.csv('./data/urban_pop.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data1 = rename(data1, "country"=X.U.FEFF.country)
star4=left_join(star3, data1, by='country')
head(star1)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
star5=left_join(star4, data2, by='country')
head(star5)
data3 = read.csv('./data/business.csv')
star6=left_join(star5, data3, by='country')
data3 = read.csv('./data/business.csv')
star6=left_join(star5, data3, by='country')
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
#Merge code and starbucks so we can have a complete for the country
star2= full_join(star1, code, by='Country')
star3= star2 %>%
mutate(store_count= ifelse(is.na(store_count), 0, store_count))
names(star3) = tolower(names(star3))
star3= rename(star3, code= 'country',
country ='country_name')
data1 = read.csv('./data/urban_pop.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data1 = rename(data1, "country"=X.U.FEFF.country)
star4=left_join(star3, data1, by='country')
head(star1)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
star5=left_join(star4, data2, by='country')
head(star5)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data3 = read.csv('./data/business.csv', encoding="UTF-8", stringsAsFactors=FALSE))
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data3 = read.csv('./data/business.csv', encoding="UTF-8", stringsAsFactors=FALSE)
star6=left_join(star5, data3, by='country')
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
data1 = read.csv('./data/urban_pop.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data1 = rename(data1, "country"=X.U.FEFF.country)
star4=left_join(star3, data1, by='country')
head(star1)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
star5=left_join(star4, data2, by='country')
head(star5)
data3 = read.csv('./data/business.csv', encoding="UTF-8", stringsAsFactors=FALSE)
star6=left_join(star5, data3, by='country')
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data3 = read.csv('./data/business.csv', encoding="UTF-8", stringsAsFactors=FALSE)
star6=left_join(star5, data3, by='country')
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
head(data3)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data3 = rename(data3, "country"=X.U.FEFF.country)
star6=left_join(star5, data3, by='country')
head(star6)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data4 = read.csv('./data/median.csv', encoding="UTF-8", stringsAsFactors=FALSE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
head(data4)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
star7=left_join(star6, data4, by='country')
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data5 = read.csv('./data/coffee_price.csv', encoding="UTF-8", stringsAsFactors=FALSE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
head(data5)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
write.csv(star7, "./data/star.csv")
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")
corr1 = star1 %>%
group_by(country, urban_pop) %>%
summarise(count= sum(store_count))
ggplot(data=corr1, aes(x=urban_pop, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")+
xlab("urban population(log(10))")+
ylab("number of stores(log(10))")+
ggtitle("Number Of Stores vs Urban Population")
runApp()
runApp()
runApp()
runApp()
runApp()
corr2 = star1 %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count)) %>%
ggplot(aes(x=gdp, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")+
xlab("GDP per capita(log(10))")+
ylab("number of stores(log(10))")+
ggtitle("Number Of Stores vs GDP Per Capita"))
corr2 = star1 %>%
group_by(country, gdp) %>%
summarise(count= sum(store_count)) %>%
ggplot(aes(x=gdp, y=count))+
scale_x_log10()+
scale_y_log10()+
geom_point()+
geom_smooth(method = "lm")+
xlab("GDP per capita(log(10))")+
ylab("number of stores(log(10))")+
ggtitle("Number Of Stores vs GDP Per Capita")
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country, "gdp"=X2019)
code = read.csv('./data/country_code.csv')
code= code%>%
mutate(Country_Name= word(Country_Name, 1, sep=','))
code = code %>%
mutate(Country_Name= ifelse(Country_Name=='Azerbaijan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Georgia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Kazakhstan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Russian Federation' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Armenia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Korea' , 'South Korea',Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='United States of America' , 'United States',Country_Name))
code = code %>%
filter(Country_Name != 'NULL')
code= rename(code, continent= 'Continent_Name',
Country= 'Two_Letter_Country_Code')
code = code %>%
filter(Country_Name != '')
head(code, 5)
#Merge code and starbucks so we can have a complete for the country
star2= full_join(star1, code, by='Country')
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
knitr::opts_chunk$set(echo = TRUE)
starbucks = read.csv('./data/starbucks2.csv', stringsAsFactors=FALSE)
starbucks$store_count = rep(1, dim(starbucks)[1])
star1= starbucks%>%
select(c(-Postcode, -Phone.Number))
head(star1)
code = read.csv('./data/country_code.csv')
code= code%>%
mutate(Country_Name= word(Country_Name, 1, sep=','))
code = code %>%
mutate(Country_Name= ifelse(Country_Name=='Azerbaijan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Georgia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Kazakhstan' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Russian Federation' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Armenia' & Continent_Name=='Asia', '', Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='Korea' , 'South Korea',Country_Name)) %>%
mutate(Country_Name= ifelse(Country_Name=='United States of America' , 'United States',Country_Name))
code = code %>%
filter(Country_Name != 'NULL')
code= rename(code, continent= 'Continent_Name',
Country= 'Two_Letter_Country_Code')
code = code %>%
filter(Country_Name != '')
head(code, 5)
#Merge code and starbucks so we can have a complete for the country
star2= full_join(star1, code, by='Country')
star3= star2 %>%
mutate(store_count= ifelse(is.na(store_count), 0, store_count))
names(star3) = tolower(names(star3))
star3= rename(star3, code= 'country',
country ='country_name')
data1 = read.csv('./data/urban_pop.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data1 = rename(data1, "country"=X.U.FEFF.country)
star4=left_join(star3, data1, by='country')
head(star1)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
head(data2)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
data2 = read.csv('./data/gdp_per_capita.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data2 = rename(data2, "country"=X.U.FEFF.country)
head(data2)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(stringr)
star5=left_join(star4, data2, by='country')
head(star5)
data3 = read.csv('./data/business.csv', encoding="UTF-8", stringsAsFactors=FALSE)
data3 = rename(data3, "country"=X.U.FEFF.country)
star6=left_join(star5, data3, by='country')
head(star6)
data4 = read.csv('./data/median.csv', encoding="UTF-8", stringsAsFactors=FALSE)
star7=left_join(star6, data4, by='country')
write.csv(star7, "./data/star.csv")
runApp()
runApp()
head(star1)
runApp()
runApp()
runApp()
library(ggpairs)
install.packages("ggpairs")
library(ggpairs)
install.packages("GGally")
library(GGally)
multi= star1 %>%
group_by(country, median_age, bus_score, urban_pop, gdp) %>%
summarise(count= sum(store_count))
multi_col = multi[, -c(1)]
multi= star1 %>%
group_by(country, median_age, bus_score, urban_pop, gdp) %>%
summarise(count= sum(store_count))
multi_col = multi[, -c(1)]
multi_col
ggcorr(multi_col, palette = "RdBu", label = TRUE)
multi= star1 %>%
group_by(country, median_age, bus_score, urban_pop, gdp) %>%
summarise(count= sum(store_count))
multi_col = multi[, -c(1, 2)]
ggcorr(multi_col, palette = "RdBu", label = TRUE)
multi= star1 %>%
group_by(country, median_age, bus_score, urban_pop, gdp) %>%
summarise(count= sum(store_count))
multi_col = multi[, -c(1, 6)]
ggcorr(multi_col, palette = "RdBu", label = TRUE)
multi= star1 %>%
group_by(country, median_age, bus_score, urban_pop, gdp, coffe_price) %>%
summarise(count= sum(store_count))
multi_col = multi[, -c(1, 6)]
ggcorr(multi_col, palette = "RdBu", label = TRUE)
head(star1)
runApp()
runApp()
runApp()
